<<<<<<< HEAD
<!--
Purpose: Main homepage UI with helplines, map, news, vehicle selector, route suggestion, and navigation.
-->
<!DOCTYPE html>
<html>
<head>
    <title>SafeRouteAI - Sirsa Flood & Blocked Road Navigator</title>
    <link rel="stylesheet" href="{% static 'roads/main.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
    <header>
        <h1>SafeRouteAI - Sirsa Flood & Blocked Road Navigator</h1>
    </header>
    <section class="helpline-panel">
        <h2>Emergency & Local Helplines</h2>
        <ul>
            {% for h in helplines %}
            <li><strong>{{ h.label }}:</strong> <a href="tel:{{ h.number }}">{{ h.number }}</a></li>
            {% endfor %}
        </ul>
    </section>
    <section class="news-panel" id="news-panel"></section>
    <section class="map-container">
        <div id="map" style="height:500px;width:100%;"></div>
    </section>
    <section>
        <form>
            <label>Vehicle Type:</label>
            <select id="vehicle-type">
                <option value="pedestrian">Pedestrian</option>
                <option value="bicycle">Bicycle</option>
                <option value="car" selected>Car</option>
                <option value="bus">Bus</option>
                <option value="truck">Truck</option>
            </select>
        </form>
        <form id="route-form">
            <label>Origin (lng,lat):</label>
            <input type="text" id="origin" required>
            <label>Destination (lng,lat):</label>
            <input type="text" id="destination" required>
            <button type="submit">Suggest Route</button>
        </form>
        <div id="suggested-route"></div>
        <a href="{% url 'report' %}">Report a Blocked Road</a> |
        <a href="{% url 'blocked_list' %}">See Blocked Roads</a>
    </section>
    <footer>
        <small>
            Powered by OpenStreetMap, Leaflet, Django, OpenWeatherMap, NewsAPI | &copy; 2025 SafeRouteAI
        </small>
    </footer>
    <script>
        var map = L.map('map').setView({{ city_center }}, 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        function loadBlockedRoads(vehicle) {
            fetch("{% url 'blocked_roads' %}?vehicle=" + vehicle)
            .then(response => response.json())
            .then(data => {
                if (window.blockedLayer) map.removeLayer(window.blockedLayer);
                window.blockedLayer = L.geoJSON(data, {
                    style: { color: "red", weight: 4 },
                    onEachFeature: function (feature, layer) {
                        if (feature.properties) {
                            layer.bindPopup(
                                "<b>" + (feature.properties.name || "Road") + "</b><br>" +
                                (feature.properties.reason || "Blocked")
                            );
                        }
                    }
                }).addTo(map);
            });
        }

        document.getElementById("vehicle-type").addEventListener("change", function(e) {
            loadBlockedRoads(e.target.value);
        });

        // Initial load
        loadBlockedRoads(document.getElementById("vehicle-type").value);

        // Fetch flood/blockage news
        fetch("{% url 'flood_news' %}")
        .then(response => response.json())
        .then(data => {
            var panel = document.getElementById("news-panel");
            panel.innerHTML = "<h2>Latest Flood & Blocked Road News</h2><ul>" +
                data.articles.map(article =>
                    `<li><a href="${article.url}" target="_blank">${article.title}</a> <small>(${article.source.name})</small></li>`
                ).join("") +
                "</ul>";
        });

        // Route suggestion handler
        document.getElementById("route-form").addEventListener("submit", function(e) {
            e.preventDefault();
            var origin = document.getElementById("origin").value;
            var destination = document.getElementById("destination").value;
            var vehicle = document.getElementById("vehicle-type").value;
            fetch("{% url 'route_suggestion' %}?origin=" + origin + "&destination=" + destination + "&vehicle=" + vehicle)
            .then(response => response.json())
            .then(data => {
                document.getElementById("suggested-route").innerText =
                  data.features && data.features[0]
                  ? "Route: " + JSON.stringify(data.features[0].geometry.coordinates)
                  : "No route found";
            });
        });
    </script>
</body>
</html>
=======
<!--
Purpose: Main homepage UI with helplines, map, news, vehicle selector, route suggestion, and navigation.
-->
<!DOCTYPE html>
<html>
<head>
    <title>SafeRouteAI - Sirsa Flood & Blocked Road Navigator</title>
    <link rel="stylesheet" href="{% static 'roads/main.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
    <header>
        <h1>SafeRouteAI - Sirsa Flood & Blocked Road Navigator</h1>
    </header>
    <section class="helpline-panel">
        <h2>Emergency & Local Helplines</h2>
        <ul>
            {% for h in helplines %}
            <li><strong>{{ h.label }}:</strong> <a href="tel:{{ h.number }}">{{ h.number }}</a></li>
            {% endfor %}
        </ul>
    </section>
    <section class="news-panel" id="news-panel"></section>
    <section class="map-container">
        <div id="map" style="height:500px;width:100%;"></div>
    </section>
    <section>
        <form>
            <label>Vehicle Type:</label>
            <select id="vehicle-type">
                <option value="pedestrian">Pedestrian</option>
                <option value="bicycle">Bicycle</option>
                <option value="car" selected>Car</option>
                <option value="bus">Bus</option>
                <option value="truck">Truck</option>
            </select>
        </form>
        <form id="route-form">
            <label>Origin (lng,lat):</label>
            <input type="text" id="origin" required>
            <label>Destination (lng,lat):</label>
            <input type="text" id="destination" required>
            <button type="submit">Suggest Route</button>
        </form>
        <div id="suggested-route"></div>
        <a href="{% url 'report' %}">Report a Blocked Road</a> |
        <a href="{% url 'blocked_list' %}">See Blocked Roads</a>
    </section>
    <footer>
        <small>
            Powered by OpenStreetMap, Leaflet, Django, OpenWeatherMap, NewsAPI | &copy; 2025 SafeRouteAI
        </small>
    </footer>
    <script>
        var map = L.map('map').setView({{ city_center }}, 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        function loadBlockedRoads(vehicle) {
            fetch("{% url 'blocked_roads' %}?vehicle=" + vehicle)
            .then(response => response.json())
            .then(data => {
                if (window.blockedLayer) map.removeLayer(window.blockedLayer);
                window.blockedLayer = L.geoJSON(data, {
                    style: { color: "red", weight: 4 },
                    onEachFeature: function (feature, layer) {
                        if (feature.properties) {
                            layer.bindPopup(
                                "<b>" + (feature.properties.name || "Road") + "</b><br>" +
                                (feature.properties.reason || "Blocked")
                            );
                        }
                    }
                }).addTo(map);
            });
        }

        document.getElementById("vehicle-type").addEventListener("change", function(e) {
            loadBlockedRoads(e.target.value);
        });

        // Initial load
        loadBlockedRoads(document.getElementById("vehicle-type").value);

        // Fetch flood/blockage news
        fetch("{% url 'flood_news' %}")
        .then(response => response.json())
        .then(data => {
            var panel = document.getElementById("news-panel");
            panel.innerHTML = "<h2>Latest Flood & Blocked Road News</h2><ul>" +
                data.articles.map(article =>
                    `<li><a href="${article.url}" target="_blank">${article.title}</a> <small>(${article.source.name})</small></li>`
                ).join("") +
                "</ul>";
        });

        // Route suggestion handler
        document.getElementById("route-form").addEventListener("submit", function(e) {
            e.preventDefault();
            var origin = document.getElementById("origin").value;
            var destination = document.getElementById("destination").value;
            var vehicle = document.getElementById("vehicle-type").value;
            fetch("{% url 'route_suggestion' %}?origin=" + origin + "&destination=" + destination + "&vehicle=" + vehicle)
            .then(response => response.json())
            .then(data => {
                document.getElementById("suggested-route").innerText =
                  data.features && data.features[0]
                  ? "Route: " + JSON.stringify(data.features[0].geometry.coordinates)
                  : "No route found";
            });
        });
    </script>
</body>
</html>
>>>>>>> 2f55220dae0bb14c7c90517c68fd70ac27d114b2
